const REPORT_AA_WORKER_URL="https://report-aa.kumar8948rahul.workers.dev",REPORT_AA_CONFIG={maxPerDay:5,storageKey:"report_aa_daily_submissions",dateKey:"report_aa_last_submission_date",notificationDelay:3e3},fab=document.getElementById("report-aa-fab"),notification=document.getElementById("report-aa-notification"),modal=document.getElementById("report-aa-modal"),closeBtn=document.getElementById("report-aa-close"),submitBtn=document.getElementById("report-aa-submit-btn"),submitText=document.getElementById("report-aa-submit-text"),messageInput=document.getElementById("report-aa-message"),screenshotInput=document.getElementById("report-aa-screenshot"),countDisplay=document.getElementById("report-aa-count-display"),progressBar=document.getElementById("report-aa-progress-bar"),limitText=document.getElementById("report-aa-limit-text"),formContainer=document.getElementById("report-aa-form-container"),successMsg=document.getElementById("report-aa-success"),loadingDiv=document.getElementById("report-aa-loading");function getToday(){return new Date().toISOString().split("T")[0]}function getSubmissionsCount(){let e=getToday(),t=localStorage.getItem(REPORT_AA_CONFIG.dateKey),a=localStorage.getItem(REPORT_AA_CONFIG.storageKey);return t!==e?(localStorage.setItem(REPORT_AA_CONFIG.dateKey,e),localStorage.setItem(REPORT_AA_CONFIG.storageKey,"0"),0):parseInt(a||"0",10)}function incrementSubmissionCount(){let e=getSubmissionsCount();return localStorage.setItem(REPORT_AA_CONFIG.storageKey,(e+1).toString()),e+1}function updateUIWithLocalLimit(){let e=getSubmissionsCount(),t=Math.max(0,REPORT_AA_CONFIG.maxPerDay-e),a=e/REPORT_AA_CONFIG.maxPerDay*100;progressBar.style.width=`${a}%`,e>=REPORT_AA_CONFIG.maxPerDay?(progressBar.style.background="linear-gradient(90deg, #ff6b6b, #ff4757)",countDisplay.innerHTML=`
      <span style="color: #ff6b6b;">â›” Daily Limit Reached</span>
      <div style="font-size: 13px; opacity: 0.7;">Come back tomorrow!</div>
    `,limitText.textContent=`You've submitted ${e} feedbacks today`,submitBtn.disabled=!0,submitText.textContent="Daily Limit Reached"):(progressBar.style.background=e>=3?"linear-gradient(90deg, #f59e0b, #ffa502)":"linear-gradient(90deg, #60c994, #2ed573)",countDisplay.innerHTML=`
      <span style="color: ${e>=3?"#f59e0b":"#60c994"}">
        ðŸ“Š ${t} of ${REPORT_AA_CONFIG.maxPerDay} submissions remaining
      </span>
    `,limitText.textContent=`You've submitted ${e} feedback${1!==e?"s":""} today`,submitBtn.disabled=!1,submitText.textContent=e>=3?"\uD83D\uDE80 Submit (Careful!)":"\uD83D\uDE80 Submit Feedback")}function showNotification(){"flex"!==modal.style.display&&(notification.style.display="flex",setTimeout(()=>{"flex"===notification.style.display&&(notification.style.display="none")},8e3))}async function submitReportAa(){let e=messageInput.value.trim(),t=screenshotInput.value.trim();if(!e){alert("\uD83D\uDCDD Please write your feedback or describe the problem."),messageInput.focus();return}let a=getSubmissionsCount();if(a>=REPORT_AA_CONFIG.maxPerDay){alert(`â›” Daily limit reached! You can submit ${REPORT_AA_CONFIG.maxPerDay} feedbacks per day.`);return}if(t&&!isValidUrl(t)){alert("\uD83D\uDD17 Please enter a valid URL for the screenshot."),screenshotInput.focus();return}submitBtn.disabled=!0,submitText.textContent="Sending... âœ¨";let i={message:e,screenshotUrl:t||null,localLimitUsed:a+1,timestamp:new Date().toISOString()};try{let n=await fetch("https://report-aa.kumar8948rahul.workers.dev",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)}),s=await n.json();if(!s.success)throw Error(s.error||"Submission failed");incrementSubmissionCount(),formContainer.style.display="none",successMsg.style.display="block",setTimeout(()=>{modal.style.display="none",setTimeout(()=>{successMsg.style.display="none",formContainer.style.display="block",messageInput.value="",screenshotInput.value="",submitBtn.disabled=!1,submitText.textContent="\uD83D\uDE80 Submit Feedback",updateUIWithLocalLimit()},300)},4e3)}catch(o){alert(`âŒ Error: ${o.message}`),submitBtn.disabled=!1,submitText.textContent="\uD83D\uDE80 Submit Feedback",updateUIWithLocalLimit()}}function isValidUrl(e){try{return new URL(e),!0}catch(t){return!1}}setTimeout(showNotification,REPORT_AA_CONFIG.notificationDelay),fab.addEventListener("click",()=>{modal.style.display="flex",notification.style.display="none",updateUIWithLocalLimit()}),closeBtn.addEventListener("click",()=>{modal.style.display="none"}),notification.addEventListener("click",()=>{modal.style.display="flex",notification.style.display="none",updateUIWithLocalLimit()}),window.innerWidth>=769&&modal.addEventListener("click",e=>{(e.target===modal||e.target.classList.contains("report-aa-color-flow"))&&(modal.style.display="none")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"flex"===modal.style.display&&(modal.style.display="none")}),submitBtn.addEventListener("click",submitReportAa),updateUIWithLocalLimit(),messageInput.addEventListener("keydown",e=>{"Enter"!==e.key||e.shiftKey||e.preventDefault()}),messageInput.addEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"});let scrollTimeout;window.addEventListener("scroll",()=>{"flex"===notification.style.display&&(notification.style.opacity="0.5",clearTimeout(scrollTimeout),scrollTimeout=setTimeout(()=>{notification.style.opacity="1"},200))});const placeholderText="\uD83D\uDCAD Type your brilliant ideas, feedback, or suggestions here...";let placeholderIndex=0;function typePlaceholder(){document.activeElement!==messageInput&&(messageInput.placeholder=placeholderText.substring(0,placeholderIndex),++placeholderIndex>placeholderText.length&&(placeholderIndex=0))}function createConfetti(){let e=["#667eea","#ff6b6b","#60c994","#f59e0b","#8b5cf6"];for(let t=0;t<50;t++){let a=document.createElement("div");a.style.position="fixed",a.style.width="10px",a.style.height="10px",a.style.background=e[Math.floor(Math.random()*e.length)],a.style.borderRadius="50%",a.style.left=100*Math.random()+"vw",a.style.top="-20px",a.style.zIndex="10002",a.style.pointerEvents="none",a.style.animation=`confetti-fall ${1+2*Math.random()}s linear forwards`,document.body.appendChild(a),setTimeout(()=>a.remove(),2e3)}}setInterval(typePlaceholder,50);const style=document.createElement("style");style.textContent=`
  @keyframes confetti-fall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
  }
`,document.head.appendChild(style);const originalSubmitFunction=submitReportAa;window.submitReportAa=async function(){await originalSubmitFunction(),"block"===successMsg.style.display&&setTimeout(createConfetti,100)};